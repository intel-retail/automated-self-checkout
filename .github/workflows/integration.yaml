name: Integration Tests

on: 
  push:
    branches: [ "main" ]
  pull_request:
    # The branches below must be a subset of the branches above
    branches: [ "main" ]

permissions:
  contents: read

jobs:
  run_integration_tests:
      runs-on: [self-hosted, linux, x64]
      steps:
          - name: Cleanup repo build folder
            run: |
              ls -la ./
              rm -rf ./* || true
              ls -la ./
          - name: Checkout code
            uses: actions/checkout@v3
          - name: run integration tests
            run: |
              make run-smoke-tests
